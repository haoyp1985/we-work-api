# AI智能体管理系统 - 系统集成测试计划

## 📋 测试概述

本测试计划旨在确保AI智能体管理系统的前后端能够正常通信，所有功能模块运行正常。

### 🎯 测试目标
- ✅ 验证后端服务正常启动
- ✅ 验证前端应用正常访问
- ✅ 验证API接口通信正常
- ✅ 验证数据库连接和操作
- ✅ 验证各功能模块完整性

## 🏗️ 系统架构确认

### 后端服务架构
```
前端 (3000) -> 网关服务 (18080) -> AI智能体服务 (18086)
                                 -> 其他微服务...
```

### 服务端口分配
- **前端开发服务器**: 3000
- **网关服务**: 18080  
- **AI智能体服务**: 18086
- **账号服务**: 18081
- **消息服务**: 18082
- **监控服务**: 18083

### 数据库配置
- **数据库**: MySQL (ai_agent_platform)
- **缓存**: Redis (database: 6)
- **消息队列**: RocketMQ

## 🔧 发现的配置问题

### ❌ 问题1: 网关路由配置缺失
**问题**: gateway-service配置中缺少AI智能体服务的路由规则
**影响**: 前端无法通过网关访问AI智能体API

### ❌ 问题2: 网关服务端口未明确
**问题**: gateway-service的application.yml中未明确指定端口
**影响**: 服务端口可能不是期望的18080

## 🛠️ 配置修复方案

### 1. 修复网关路由配置
需要在gateway-service的application.yml中添加AI智能体服务路由：

```yaml
# AI智能体服务路由
- id: ai-agent-service
  uri: lb://ai-agent-service
  predicates:
    - Path=/api/v1/agents/**,/api/v1/platforms/**,/api/v1/models/**,/api/v1/conversations/**,/api/v1/calls/**
  filters:
    - name: RequestRateLimiter
      args:
        redis-rate-limiter.replenishRate: 100
        redis-rate-limiter.burstCapacity: 200
        key-resolver: "#{@ipKeyResolver}"
    - name: Hystrix
      args:
        name: ai-agent-service
        fallbackUri: forward:/fallback/ai-agent-service
```

### 2. 确认网关服务端口
在gateway-service的application.yml中添加：

```yaml
server:
  port: ${PORT:18080}
```

## 📝 测试清单

### Phase 1: 基础设施测试
- [ ] **数据库连接测试**
  - [ ] MySQL服务启动
  - [ ] ai_agent_platform数据库存在
  - [ ] 所有表结构创建完成
  - [ ] 初始数据插入成功

- [ ] **Redis连接测试**
  - [ ] Redis服务启动
  - [ ] 缓存读写正常

- [ ] **RocketMQ连接测试**
  - [ ] NameServer启动
  - [ ] 消息生产消费正常

### Phase 2: 后端服务测试
- [ ] **AI智能体服务 (18086)**
  - [ ] 服务正常启动
  - [ ] Swagger文档可访问
  - [ ] 健康检查通过
  - [ ] 数据库连接正常

- [ ] **网关服务 (18080)**  
  - [ ] 服务正常启动
  - [ ] 路由配置生效
  - [ ] 转发功能正常

### Phase 3: API接口测试
- [ ] **智能体管理API**
  - [ ] GET /api/v1/agents - 获取智能体列表
  - [ ] POST /api/v1/agents - 创建智能体
  - [ ] GET /api/v1/agents/{id} - 获取智能体详情
  - [ ] PUT /api/v1/agents/{id} - 更新智能体
  - [ ] DELETE /api/v1/agents/{id} - 删除智能体

- [ ] **平台配置API**
  - [ ] GET /api/v1/platforms - 获取平台配置列表
  - [ ] POST /api/v1/platforms - 创建平台配置
  - [ ] PUT /api/v1/platforms/{id} - 更新平台配置
  - [ ] DELETE /api/v1/platforms/{id} - 删除平台配置

- [ ] **模型配置API**
  - [ ] GET /api/v1/models - 获取模型配置列表
  - [ ] POST /api/v1/models - 创建模型配置
  - [ ] PUT /api/v1/models/{id} - 更新模型配置
  - [ ] DELETE /api/v1/models/{id} - 删除模型配置

- [ ] **对话管理API**
  - [ ] GET /api/v1/conversations - 获取对话列表
  - [ ] POST /api/v1/conversations - 创建对话
  - [ ] POST /api/v1/conversations/{id}/messages - 发送消息
  - [ ] GET /api/v1/conversations/{id}/messages - 获取消息历史

- [ ] **调用记录API**
  - [ ] GET /api/v1/calls - 获取调用记录
  - [ ] GET /api/v1/calls/statistics - 获取调用统计
  - [ ] GET /api/v1/calls/{id} - 获取调用详情

### Phase 4: 前端功能测试
- [ ] **页面访问测试**
  - [ ] 登录页面正常显示
  - [ ] 主页面正常显示
  - [ ] 路由跳转正常

- [ ] **智能体管理页面**
  - [ ] 智能体列表加载
  - [ ] 创建智能体功能
  - [ ] 编辑智能体功能
  - [ ] 删除智能体功能
  - [ ] 智能体状态切换

- [ ] **平台配置页面**
  - [ ] 平台配置列表加载
  - [ ] 创建平台配置
  - [ ] 编辑平台配置
  - [ ] 删除平台配置
  - [ ] 配置测试连接

- [ ] **模型配置页面**
  - [ ] 模型配置列表加载
  - [ ] 创建模型配置
  - [ ] 编辑模型配置
  - [ ] 删除模型配置
  - [ ] 模型参数调优

- [ ] **对话聊天页面**
  - [ ] 对话界面显示
  - [ ] 发送消息功能
  - [ ] 消息历史加载
  - [ ] 实时消息接收
  - [ ] 文件上传功能

- [ ] **监控看板页面**
  - [ ] 统计数据显示
  - [ ] 图表正常渲染
  - [ ] 时间范围筛选
  - [ ] 数据实时刷新
  - [ ] 调用记录查询

### Phase 5: 端到端测试
- [ ] **完整业务流程**
  - [ ] 创建平台配置 -> 创建模型配置 -> 创建智能体 -> 发起对话 -> 查看监控

- [ ] **异常情况测试**
  - [ ] 网络断开恢复
  - [ ] 服务重启
  - [ ] 数据库连接异常
  - [ ] 大量并发请求

## 🚀 测试执行计划

### Step 1: 配置修复
1. 修复网关路由配置
2. 确认服务端口配置
3. 验证前端代理配置

### Step 2: 服务启动
1. 启动基础设施服务 (MySQL, Redis, RocketMQ)
2. 启动后端服务 (gateway-service, ai-agent-service)
3. 启动前端开发服务器

### Step 3: 自动化测试
1. 运行API接口测试
2. 执行前端功能测试
3. 进行端到端测试

### Step 4: 问题记录和修复
1. 记录发现的问题
2. 分析问题原因
3. 实施修复方案
4. 验证修复效果

## 📊 测试结果记录

### 测试环境
- **操作系统**: [待填写]
- **JDK版本**: Java 17+
- **Node.js版本**: 18+
- **数据库版本**: MySQL 8.0+
- **Redis版本**: 7.0+

### 测试执行时间
- **开始时间**: [待填写]
- **结束时间**: [待填写]
- **总耗时**: [待填写]

### 测试结果统计
- **总测试项**: 0
- **通过项**: 0  
- **失败项**: 0
- **成功率**: 0%

### 发现的问题
| 问题ID | 问题描述 | 严重程度 | 状态 | 修复方案 |
|--------|----------|----------|------|----------|
| I001   | [问题描述] | [高/中/低] | [待修复/已修复] | [修复方案] |

## ✅ 测试通过标准

### 基础标准
- 所有服务正常启动，无错误日志
- 所有API接口返回正确响应
- 前端页面正常显示和交互
- 数据库操作正常执行

### 性能标准  
- API响应时间 < 2秒
- 页面加载时间 < 3秒
- 并发处理能力 > 100 QPS

### 稳定性标准
- 连续运行4小时无异常
- 内存使用稳定，无内存泄漏
- 错误率 < 0.1%

## 📞 应急联系

如在测试过程中遇到严重问题，请联系：
- **技术负责人**: [联系方式]
- **运维负责人**: [联系方式]
- **项目经理**: [联系方式]